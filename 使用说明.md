# ComfyUI启动器使用说明 - 增强版

## 概述
ComfyUI启动器增强版是一个功能完善的图形化界面工具，用于方便地启动和管理ComfyUI。它提供了预设的代理配置、完整的启动选项、版本信息展示与批量更新功能，并具备美化的用户界面。

## 主要功能

### 1. 启动选项
- **计算模式选择**：
  - GPU模式：使用显卡加速（推荐）
  - CPU模式：使用CPU计算（适用于无显卡或显卡不兼容的情况）

### 2. 网络配置（预设选项，无需手动填写）
- **HuggingFace镜像**：自动使用hf-mirror.com加速模型下载
- **Git代理**：预设127.0.0.1:7890代理服务器
- **PyPI镜像**：预设清华大学PyPI镜像源

### 3. 启动选项（对应bat文件功能）
- **快速模式**：启用fp16_accumulation加速
- **跨域访问**：启用CORS头部支持
- **监听所有地址**：允许外部访问（0.0.0.0）
- **自定义端口**：可设置非默认端口（默认8188）

### 4. 版本与更新
- 展示 ComfyUI 内核、前端与模板库版本
- 支持选择更新项目并批量更新
- 快速刷新当前状态

### 5. 快捷操作
- **打开ComfyUI**：直接在浏览器中打开ComfyUI界面
- **打开日志**：直接打开ComfyUI日志目录
- **保存设置**：保存当前配置
- **重置设置**：恢复默认配置

## 使用方法

### 启动ComfyUI
1. 选择计算模式（GPU或CPU）
2. 根据网络环境勾选相应的代理选项
3. 选择需要的启动选项（快速模式、CORS等）
4. 设置端口号（可选）
5. 点击"启动ComfyUI"按钮
6. 等待ComfyUI启动完成

### 停止ComfyUI
- 点击"停止ComfyUI"按钮
- 或直接关闭启动器窗口（会提示是否停止ComfyUI）

### 版本与更新
1. 点击“更新状态”获取最新版本信息
2. 在“批量更新”中勾选需要更新的组件
3. 点击“更新”执行对应更新

### 快捷操作
- **打开ComfyUI**：启动后点击此按钮直接在浏览器中访问
- **打开日志**：查看ComfyUI运行日志和错误信息
- **保存设置**：保存当前的所有配置选项
- **重置设置**：恢复到默认配置

## 预设配置说明

### Git代理配置
- 默认代理地址：`http://127.0.0.1:7890`
- 适用于使用Clash、V2Ray等代理工具的用户
- 勾选后自动设置HTTP_PROXY和HTTPS_PROXY环境变量

### PyPI镜像配置
- 默认镜像源：`https://pypi.tuna.tsinghua.edu.cn/simple/`
- 使用清华大学PyPI镜像，加速Python包安装
- 勾选后自动设置PIP_INDEX_URL环境变量

### HuggingFace镜像配置
- 默认镜像地址：`https://hf-mirror.com`
- 加速Hugging Face模型下载
- 勾选后自动设置HF_ENDPOINT环境变量

## 启动选项对应关系

| 启动器选项 | 对应bat文件 | 命令行参数 |
|-----------|------------|-----------|
| GPU模式 | run_nvidia_gpu.bat | 默认 |
| CPU模式 | run_cpu.bat | --cpu |
| 快速模式 | run_nvidia_gpu_fast_fp16_accumulation.bat | --fast fp16_accumulation |
| 跨域访问 | *_hf_mirror.bat | --enable-cors-header * |
| 监听所有地址 | *_hf_mirror.bat | --listen 0.0.0.0 |
| 自定义端口 | - | --port [端口号] |

## 配置文件
启动器的配置保存在`launcher/config.json`文件中，包含：
- 默认启动选项
- 路径配置
- 代理设置
- UI偏好设置

## 文件结构
```
ComfyUI_Mie_V7.0/
├── ComfyUI启动器_增强版.exe   # 增强版主程序
├── ComfyUI启动器.exe          # 原版主程序
├── ComfyUI/                   # ComfyUI主程序目录
├── python_embeded/            # 内嵌Python环境
├── launcher/                  # 启动器源码目录
│   ├── comfyui_launcher_enhanced.py  # 增强版源码
│   ├── version_manager.py
│   ├── config.json
│   └── build_exe.py
└──（已移除备份相关目录与功能）
```

## 界面改进
- 使用现代Vista主题
- 优化字体和布局
- 添加进度条显示
- 分组显示功能模块
- 状态实时更新

## 注意事项
1. 首次运行时会自动创建配置文件
2. 确保ComfyUI目录和python_embeded目录存在
3. 代理设置为预设选项，适合大多数用户环境
4. 如果遇到启动问题，可以查看日志文件夹中的错误信息

## 故障排除
- **启动失败**：检查python_embeded目录是否完整
- **界面无响应**：等待ComfyUI完全启动，或重启启动器
（已移除备份相关内容）
- **代理无效**：确认本地代理服务是否正常运行
- **端口冲突**：更改端口号或关闭占用端口的程序

## 技术支持
如遇到问题，请检查：
1. ComfyUI目录结构是否完整
2. python_embeded是否正常工作
3. 系统防火墙或杀毒软件是否阻止程序运行
4. 日志文件中的具体错误信息
5. 代理服务器是否正常运行（如果启用了代理选项）